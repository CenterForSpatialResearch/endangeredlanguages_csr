<!DOCTYPE html>
<html>
	<head>
	 	<meta charset="UTF-8">
	    <title>testing basic</title>
	    <link rel="stylesheet" type="text/css" href="../css/testingbasic.css">
	    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	</head>

    <style type="text/css">
   	    /*css styling here */

   	    /* Make the chart container fill the page using CSS. */
	      #chart {
	        position: fixed;
	        left: 0px;
	        right: 0px;
	        top: 0px;
	        bottom: 0px;
	      }

    </style>

	<body>
    
    <div class="bodyPanel">
      <div class="container">
        <div class="row">
          
          <div class="col-md-9">
          	<ul class="selections">
              <p> 
                <li>Select buildings that are</li>
                <li><input class="updateButton" id="unbuilding" type="button" value="multilingual"></li>             
                
                <li><input class="updateButton" id="twolanguages" type="button" value="bilingual"></li> 

                <li><input class="updateButton" id="boring" type="button" value="monolingual"></li> 
              </p>
            </ul>
              <br>
            <p> Select an apartment for more information </p>
        		<div id="vis"></div>
            
          </div>

        </div>
      </div>
    </div>

    <div class="sidePanel">
      <div class="container">
        <div class="row">
          
          <div class="col-md-3">
            <p> Five languages are spoken in this building, and these are distributed within apartments. Although 12 apartments are shown, there is a lot of diversity in the buildingâ€™s 30 total apartments. </p>
            <h1 class="extraHeading"> </h1>
            <p class="extraInfo"> </p>
            <div id="visSide"></div>
          </div>

        </div>
      </div>
    </div>

	</body>

	<script src="http://d3js.org/d3.v4.min.js"></script>
 	<script src="http://d3js.org/d3-queue.v3.min.js"></script>      	
    
 	<script type="text/javascript">

    // Extract the width and height that was computed by CSS.
      var chartDiv = document.getElementById("vis");
      var width = chartDiv.clientWidth;
      var height = chartDiv.clientHeight;

      // load the external svg from a file
      d3.xml("../svg/170627buildingonly.svg").mimeType("image/svg+xml").get(function(error, xml) {
      var importedNode = document.importNode(xml.documentElement, true);
      d3.select("div#vis")
        .each(function() {
          this.appendChild(importedNode);
        })
        styleImportedSVGbasic()
      }); 


      function styleImportedSVGbasic () {
      	// d3.selectAll("#Labels").attr("visibility", "hidden") //HIDES certain elements 
      	// d3.selectAll("#Underlay").attr("visibility", "")//SHOWS
      }

    //SWITCHING BTW IMGS   
    d3.select("#unbuilding").on("click", function(){
     d3.selectAll("svg").remove();

     d3.xml("../svg/170627detail_building_web-01.svg").mimeType("image/svg+xml").get(function(error, xml) {
      var importedNode = document.importNode(xml.documentElement, true);
      d3.select("div#vis")
        .each(function() {
          this.appendChild(importedNode);
        })
        styleImportedSVG1()
      });
     });

     d3.select("#twolanguages").on("click", function(){
      d3.selectAll("svg").remove();

      d3.xml("../svg/typology_mockups-02.svg").mimeType("image/svg+xml").get(function(error, xml) {
      var importedNode = document.importNode(xml.documentElement, true);
      d3.select("div#vis")
        .each(function() {
          this.appendChild(importedNode);
        })
        styleImportedSVG2()
      });
     });

     d3.select("#boring").on("click", function(){
      d3.selectAll("svg").remove();

      d3.xml("../typology_mockups-03.svg").mimeType("image/svg+xml").get(function(error, xml) {
      var importedNode = document.importNode(xml.documentElement, true);
      d3.select("div#vis")
        .each(function() {
          this.appendChild(importedNode);
        })
        styleImportedSVG3()
      });
     });

    function styleImportedSVG1 () {
     d3.select('h1.extraHeading')
      .append('text')
       .text("Building Composition")

     d3.xml("../svg/170627chartonly.svg").mimeType("image/svg+xml").get(function(error, xml) {
      var importedNode = document.importNode(xml.documentElement, true);
      d3.select("div#visSide")
        .each(function() {
          this.appendChild(importedNode);
        })
      });
     d3.xml("../svg/170627histogramonly.svg").mimeType("image/svg+xml").get(function(error, xml) {
      var importedNode = document.importNode(xml.documentElement, true);
      d3.select("div#visSide")
        .each(function() {
          this.appendChild(importedNode);
        })
      });
     

        d3.selectAll("rect")
        .attr("clicked", false)
        //.on("mouseover", mouseover)
        .on("click", function(){
          var currentColor = this.style.fill;
          d3.select(this)
            .attr("clicked", true)
            .style("fill", currentColor);
          d3.selectAll('#right1, text')
            .style("fill-opacity",0.1)
        })

     d3.select('#right1')
        .on('mouseover', function() {
          // d3.selectAll('#right1') //this is for whatever remains highlighted 
          //   .style('fill-opacity', 1)
          //   .style('stroke-opacity', 1)
          d3.selectAll('#right2, #right3, #right4, #right5, #right6, #right7, #left1, #left2, #left3, #left4, #left5, #left6, #left7') 
            .style('fill-opacity', 0.1)
            .style('stroke-opacity', 0.3)
        })
        .on('mouseout', function() {
          d3.selectAll('#right2, #right3, #right4, #right5, #right6, #right7, #left1, #left2, #left3, #left4, #left5, #left6, #left7')
            .style('fill-opacity', 1)
            .style('stroke-opacity', 1)
        })
        .on('click', function() {
            d3.selectAll("div#visSide svg").remove();

            d3.xml("../svg/170627maponly.svg").mimeType("image/svg+xml").get(function(error, xml) {
            var importedNode = document.importNode(xml.documentElement, true);
            d3.select("div#visSide")
              .each(function() {
                this.appendChild(importedNode);
              })
            });

        	d3.select('p.extraInfo')
           .append('text')
          	.attr("class","extraInfo")
          	.text("The institutions in this neighborhood supporting this language are grocery stores, mosques and ...")
        })

    d3.select('#right2')
        .on('mouseover', function() {
          // d3.selectAll('#right1') //this is for whatever remains highlighted 
          //   .style('fill-opacity', 1)
          //   .style('stroke-opacity', 1)
          d3.selectAll('#building_png, #right1, #right3, #right4, #right5, #right6, #right7, #left1, #left2, #left3, #left4, #left5, #left6, #left7') 
            .style('fill-opacity', 0.1)
            .style('stroke-opacity', 0.3)
        })
        .on('mouseout', function() {
          d3.selectAll('#right1, #right3, #right4, #right5, #right6, #right7, #left1, #left2, #left3, #left4, #left5, #left6, #left7')
            .style('fill-opacity', 1)
            .style('stroke-opacity', 1)
        })
        .on('click', function() {
          d3.select(this)
           .append('text')
            .attr("class","extraInfo")
            .attr("x",200)
            .attr("y",200)
            .style("stroke", "#000000")
            .style("fill", "#000000")
            .text("Info")
        })

      d3.select('#right3')
        .on('mouseover', function() {
          // d3.selectAll('#right3') //this is for whatever remains highlighted 
          //   .style('fill-opacity', 1)
          //   .style('stroke-opacity', 1)
          d3.selectAll('#right2, #right1, #right4, #right5, #right6, #right7, #left1, #left2, #left3, #left4, #left5, #left6, #left7') 
            .style('fill-opacity', 0.1)
            .style('stroke-opacity', 0.3)
        })
        .on('mouseout', function() {
          d3.selectAll('#right2, #right1, #right4, #right5, #right6, #right7, #left1, #left2, #left3, #left4, #left5, #left6, #left7')
            .style('fill-opacity', 1)
            .style('stroke-opacity', 1)
        })
        .on('click', function() {
          d3.select(this)
           .append('text')
            .attr("class","extraInfo")
            .attr("x",200)
            .attr("y",200)
            .style("stroke", "#000000")
            .style("fill", "#000000")
            .text("Info")
        })

      d3.select('#right4')
        .on('mouseover', function() {
          // d3.selectAll('#right4') //this is for whatever remains highlighted 
          //   .style('fill-opacity', 1)
          //   .style('stroke-opacity', 1)
          d3.selectAll('#right2, #right3, #right1, #right5, #right6, #right7, #left1, #left2, #left3, #left4, #left5, #left6, #left7') 
            .style('fill-opacity', 0.1)
            .style('stroke-opacity', 0.3)
        })
        .on('mouseout', function() {
          d3.selectAll('#right2, #right3, #right1, #right5, #right6, #right7, #left1, #left2, #left3, #left4, #left5, #left6, #left7')
            .style('fill-opacity', 1)
            .style('stroke-opacity', 1)
        })
        .on('click', function() {
          d3.select(this)
           .append('text')
            .attr("class","extraInfo")
            .attr("x",200)
            .attr("y",200)
            .style("stroke", "#000000")
            .style("fill", "#000000")
            .text("Info")
        })

    }
   
   function styleImportedSVG2 () {
      d3.selectAll('.st0, .st1, .st2')
          .on('mouseover', function() {
            d3.select(this) //this is for whatever remains highlighted 
              .style('stroke', 'black')
              .style('stroke-width', '2')
              .style('stroke-linecap', 'butt')
              .style('stroke-linejoin', 'miter')
          })
          .on('mouseout', function() {
            d3.select(this)//have to do this again here because 137 and 138 are outside of the room2 div
              .style('stroke-width', '0')
          })
      d3.selectAll('.st0')
          .on('click', function() {
            d3.selectAll('.st1, .st0, .st2')
              .style('fill', originalColor)
              .style('fill-opacity', 1)
              .style('stroke-opacity', 1)
            d3.selectAll('.st1, .st2')
              .style('fill','black')
              .style('fill-opacity', 0.3)
              .style('stroke-opacity', 0.3)
          })
      d3.selectAll('.st1')
          .on('click', function() {
            d3.selectAll('.st1, .st0, .st2')
              .style('fill', originalColor)
              .style('fill-opacity', 1)
              .style('stroke-opacity', 1)
            d3.selectAll('.st2, .st0')
              .style('fill','black')
              .style('fill-opacity', 0.3)
              .style('stroke-opacity', 0.3)
          })
      d3.selectAll('.st2')
          .on('click', function() {
            d3.selectAll('.st1, .st0, .st2')
              .style('fill', originalColor)
              .style('fill-opacity', 1)
              .style('stroke-opacity', 1)
            d3.selectAll('.st0, .st1')
              .style('fill','black')
              .style('fill-opacity', 0.3)
              .style('stroke-opacity', 0.3)
          })

      d3.selectAll('g#Underlay')
        .on('click', function() {
            d3.selectAll('.st1, .st0, .st2')
              .style('fill', originalColor)
              .style('fill-opacity', 1)
              .style('stroke-opacity', 1)
          })

      var originalColor
      d3.selectAll('.st0, .st1, .st2')
          .attr("fill", function(d) {
           d.oldColor = d3.select(this).attr("fill");
          return originalColor;
        });
      }


    </script>

</html>