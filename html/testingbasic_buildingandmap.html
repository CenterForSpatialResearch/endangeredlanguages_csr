<!DOCTYPE html>
<html>
	<head>
	 	<meta charset="UTF-8">
	    <title>testing basic</title>
	    <link rel="stylesheet" type="text/css" href="../css/testingbasic.css">
	    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
	</head>

    <style type="text/css">
   	    /*css styling here */

   	    /* Make the chart container fill the page using CSS. */
	      #chart {
	        position: fixed;
	        left: 0px;
	        right: 0px;
	        top: 0px;
	        bottom: 0px;
	      }

    </style>

	<body>

		<div id="vis">
     	   <svg class="mapVis" width = "800" height = "600"> </svg>
		</div>

	</body>

   <script src="http://d3js.org/d3.v4.min.js"></script>
   <script src="http://d3js.org/d3-queue.v3.min.js"></script>  
   <script src="http://d3js.org/topojson.v1.min.js"></script>    
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

   <script type="text/javascript">

   //DRAWING MAP
	 var div = d3.select("body").append("div")
	    .attr("class", "tooltip")
	    .style("opacity", 0);
	  var viewportWidth = $(window).width();
		var viewportHeight = $(window).height()/2;
		var width = viewportWidth * .97;
		var height = width/1.85;
	   var projection = d3.geoMercator()
	      .center([-73.94, 40.70])
	      .scale(41000)
	      .translate([width / 2, height / 2]); 
	   var path = d3.geoPath()
	      .projection(projection);
	 //sets/creates svg window and draws  NYC map  
	   var svg = d3.select(".vis")
	      .append("svg")
	      .attr("width", width)
	      .attr("height", height)

	   d3.queue()  
	      .defer(d3.json, "../data/boroughs_NTA.json")
	      .defer(d3.csv, "../data/Pop_NTA.csv") 
	      .await(drawMap); 
	  
	  function drawMap(error,nyc,frequency){
  		if (error) throw error;
  	    console.log(nyc)
  	    console.log(frequency)

  	    d3.select("svg.mapVis")
		  .selectAll("path")
		   .data(topojson.feature(nyc, nyc.objects.NY_NTA).features) 
		  .enter().append("path")
		   .attr("d", path)
		   .style("fill", "gold")
	       .style("fill-opacity", "0.2")
	  }

	d3.select(window).on('resize', resize);
	function resize() {
	    width = parseInt(d3.select('svg.mapVis').style('width'));
	    width = $(window).width() * .97;
	    height = width/1.85;

	   projection
	    	.scale([width/3.5])
	    	.center([-73.94, 40.70])
	   		.translate([width/2,height/2]); 
	 		
	   d3.select(".vis").attr("width",width).attr("height",height);
	   
	   d3.select("svg.mapVis")
	   		.attr("width",width)
	   		.attr("height",height)
	   		.selectAll("path")
		  .enter().append("path")
		    .attr("d", path)
	}


    // Extract the width and height that was computed by CSS.
      var chartDiv = document.getElementById("vis");
      var width = chartDiv.clientWidth;
      var height = chartDiv.clientHeight;

    // load the external svg from a file
      d3.xml("../svg/typology_mockups-01.svg").mimeType("image/svg+xml").get(function(error, xml) {
      var importedNode = document.importNode(xml.documentElement, true);
      d3.select("div#vis")
        .each(function() {
          this.appendChild(importedNode);
        })
        styleImportedSVGbasic()
      }); 

      function styleImportedSVGbasic () {
      	d3.selectAll("#Labels").attr("visibility", "hidden") //HIDES certain elements 
      	// d3.selectAll("#Underlay").attr("visibility", "")//SHOWS
      }

  </script>

</html>
