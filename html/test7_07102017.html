<!DOCTYPE html>
<html>
	<head>
	 	<meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	  <title>testing basic</title>
	  <link rel="stylesheet" type="text/css" href="../css/testingbasic_07102017.css">
	  <link href="https://fonts.googleapis.com/css?family=Cousine" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.1/dist/leaflet.css" />
	</head>

  <style type="text/css">
	    /*css styling here */

	    /* Make the chart container fill the page using CSS. */
    #chart {
      position: fixed;
      left: 0px;
      right: 0px;
      top: 0px;
      bottom: 0px;
    }

    /*for map*/
    body {
          margin: 0px;
          border: 0px;
          padding: 0px;
      }

  </style>

	<body>
    
    <h1 class="title">
      linguistic diversity in buildings
    </h1>

    <div class="bodyPanel">
      <div class="container">
        <div class="row">
          
          <!-- SIDE -->
          <div class="col-md-3" id="sidePanel">

            <div id="extraHeadingBox">
              <div class="extraHeading"> </div>
            </div>

            <div id="barChart"></div>
            <p class="extraInfo"> </p>

          </div>

          <!-- BODY -->
          <div class="col-md-9" id="bodyPanel">

            <ul class="selections">
              <p> 
                <li>Select buildings that are</li>
                <li><input class="updateButton" id="unbuilding" type="button" value="multilingual"></li>             
                
                <li><input class="updateButton" id="twolanguages" type="button" value="bilingual"></li> 

                <li><input class="updateButton" id="boring" type="button" value="monolingual"></li> 
              </p>
            </ul>
        		<div id="vis"></div>
          </div>

          <hr/>

          <p id="basicText"></p>

        </div>
      </div>
    </div>

    <ul class="overlayImg">
      <li>
        <div id="visSmallMono" style = "width:300px; height:auto">    
          <div class="overlayTextMono"></div>
        </div>  
      </li> 
      <li>
        <div id="visSmallBi" style = "width:300px; height:auto">
          <div class="overlayTextBi"></div>
        </div>
      </li> 
      <li>
        <div id="visSmallMulti" style = "width:300px; height:auto">
          <div class="overlayTextMulti"></div>
        </div>
      </li>
    </ul>

	</body>
  
  <!-- leaflet -->
  <script src="https://unpkg.com/leaflet@1.0.1/dist/leaflet.js"></script>

  <!-- Main tangram library -->
  <script src="https://mapzen.com/tangram/0.10/tangram.min.js"></script>

	<script src="http://d3js.org/d3.v4.min.js"></script>
 	<script src="http://d3js.org/d3-queue.v3.min.js"></script>      	
    
 	<script type="text/javascript">

    //BUILDING VIS
     //Extract the width and height that was computed by CSS.
      var chartDiv = document.getElementById("vis");
      var width = chartDiv.clientWidth;
      var height = chartDiv.clientHeight;

      // load the external svg from a file
      d3.xml("../svg/170710_buildingonly.svg").mimeType("image/svg+xml").get(function(error, xml) {
      var importedNode = document.importNode(xml.documentElement, true);
      d3.select("div#vis")
        .each(function() {
          this.appendChild(importedNode);
        })
        styleImportedSVGbasic()
      }); 

      function styleImportedSVGbasic () {
      	// d3.selectAll("p#fakeText, div#map").style("visibility", "hidden") //HIDES certain elements 
      	// d3.selectAll("#Underlay").style("visibility", "")//SHOWS
        d3.select('p#basicText')
          .append('text')
          .text("[Some explanatory text]. Selecting any building below toggles between different types of language distribution in buildings.")
      
      }

      //SWITCHING BTW IMGS   
      d3.selectAll("#unbuilding, #visSmallMulti").on("click", function(){
        
        d3.selectAll("svg").remove();
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true);

        d3.xml("../svg/170710_buildingdetail.svg").mimeType("image/svg+xml").get(function(error, xml) {
          var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#vis")
            .each(function() {
              this.appendChild(importedNode);
            })
          importMultilingual()
        });

        d3.xml("../svg/170710_buildingonly.svg").mimeType("image/svg+xml").get(function(error, xml) {
        var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#visSmallMono")
            .each(function() {
              this.appendChild(importedNode);
            })
          addOverlay()
        }); 

        d3.xml("../svg/170710_buildingonly.svg").mimeType("image/svg+xml").get(function(error, xml) {
        var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#visSmallBi")
            .each(function() {
              this.appendChild(importedNode);
            })
        }); 

        d3.xml("../svg/170710_buildingdetail.svg").mimeType("image/svg+xml").get(function(error, xml) {
        var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#visSmallMulti")
            .each(function() {
              this.appendChild(importedNode);
            })
        }); 

       });

       d3.selectAll("#twolanguages, #visSmallBi").on("click", function(){ 
        d3.selectAll("svg").remove();
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true);

        d3.xml("../svg/typology_mockups-02.svg").mimeType("image/svg+xml").get(function(error, xml) {
        var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#vis")
            .each(function() {
              this.appendChild(importedNode);
            })
          importBilingual()
        });

        d3.xml("../svg/170710_buildingonly.svg").mimeType("image/svg+xml").get(function(error, xml) {
        var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#visSmallMono")
            .each(function() {
              this.appendChild(importedNode);
            })
          addOverlay()
        }); 

        d3.xml("../svg/170710_buildingdetail.svg").mimeType("image/svg+xml").get(function(error, xml) {
        var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#visSmallMulti")
            .each(function() {
              this.appendChild(importedNode);
            })
        }); 

        d3.xml("../svg/170710_buildingonly.svg").mimeType("image/svg+xml").get(function(error, xml) {
        var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#visSmallBi")
            .each(function() {
              this.appendChild(importedNode);
            })
        }); 

       });

       d3.selectAll("#boring, #visSmallMono").on("click", function(){       
        d3.selectAll("svg").remove();
        d3.selectAll(".updateButton").classed("updateButtonSelected", false);
        d3.select(this).classed("updateButtonSelected", true);

        d3.xml("../typology_mockups-03.svg").mimeType("image/svg+xml").get(function(error, xml) {
        var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#vis")
            .each(function() {
              this.appendChild(importedNode);
            })
          styleImportedSVG3()
        });

        d3.xml("../svg/170710_buildingonly.svg").mimeType("image/svg+xml").get(function(error, xml) {
        var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#visSmallBi")
            .each(function() {
              this.appendChild(importedNode);
            })
          addOverlay()
        }); 

        d3.xml("../svg/170710_buildingdetail.svg").mimeType("image/svg+xml").get(function(error, xml) {
        var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#visSmallMulti")
            .each(function() {
              this.appendChild(importedNode);
            })
        }); 

        d3.xml("../svg/170710_buildingonly.svg").mimeType("image/svg+xml").get(function(error, xml) {
        var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#visSmallMono")
            .each(function() {
              this.appendChild(importedNode);
            })
        }); 


       });

      function importMultilingual () {

         d3.selectAll('text.extraHeading').remove();
         d3.select('div.extraHeading')
          .append('text')
            .attr("class", "extraHeading")
           .text("Building Composition")

         d3.xml("../svg/170710_bar_bar.svg").mimeType("image/svg+xml").get(function(error, xml) {
          var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#barChart")
            .each(function() {
              this.appendChild(importedNode);
            })
          });
          styleBuildings()

      } //end of function
     
      function importBilingual () {
    

      }


      //SORTING OUT TEXT 
        var multiText = "more than two languages"
        var monoText = "one language"
        var biText = "two languages"

        var spanishDescription = "hi"
        var arabicDescription = "say something"
        var englishDescription = "hello"
        var chineseDescription = "[Information about the language, including how spoken it is in New York City. Also info about the number of people in the apartment and family relationships]"
        var chineseEnglishDescription = "[Information about the language, including how spoken it is in New York City. Also info about the number of people in the apartment and family relationships]"
        var chineseSpanishEnglishDescription = "[Information about the language, including how spoken it is in New York City. Also info about the number of people in the apartment and family relationships]"
        var polishDescription = "[Information about the language, including how spoken it is in New York City. Also info about the number of people in the apartment and family relationships]"
        var patoisDescription = "[Information about the language, including how spoken it is in New York City. Also info about the number of people in the apartment and family relationships]"
        var russianDescription = "[Information about the language, including how spoken it is in New York City. Also info about the number of people in the apartment and family relationships]"

      function addOverlay(){
        d3.selectAll('text.overlayText').remove();

        d3.selectAll('.overlayTextMulti')
            .append('text')
              .attr("class", "overlayText")
              .text(multiText)
        d3.selectAll('div#visSmallMulti')
          .on('mouseover', function () {
            d3.selectAll('div#visSmallMono, div#visSmallBi') 
              .style("opacity", 0.2)
            d3.selectAll('div#visSmallMulti') 
              .style("opacity", 1)
          })

        d3.selectAll('.overlayTextMono')
            .append('text')
              .attr("class", "overlayText")
              .text(monoText)
        d3.selectAll('div#visSmallMono')
          .on('mouseover', function () {
            d3.selectAll('div#visSmallMulti, div#visSmallBi') 
              .style("opacity", 0.2)
            d3.selectAll('div#visSmallMono') 
              .style("opacity", 1)
          })

        d3.selectAll('.overlayTextBi')
            .append('text')
              .attr("class", "overlayText")
              .text(biText)
        d3.selectAll('div#visSmallBi')
          .on('mouseover', function () {
            d3.selectAll('div#visSmallMono, div#visSmallMulti') 
              .style("opacity", 0.2)
            d3.selectAll('div#visSmallBi') 
              .style("opacity", 1)
          })
          

        d3.selectAll('div#visSmallBi, div#visSmallMulti, div#visSmallMono')
          .on('mouseout', function () {
            d3.selectAll('div#visSmallMono, div#visSmallBi, div#visSmallMulti')
              .style("opacity", 0.7)
          })

       }

      function styleBuildings () {
        console.log('did function ')
        // d3.selectAll('image#building, g#verticalsection, g#Layer_127')
        //   .style("opacity", 0.65)
        d3.selectAll('#russian_1_')
          .style('fill', 'red')

        d3.selectAll('image#building, g#underlay')
          .on('click', function() {
              d3.selectAll('#Polish, #Arabic, #Spanish, #Chinese_English, #English, #Chinese_Spanish_English, #Patois, #Russian, rect.russian, rect.patois, rect.polish, rect.arabic, rect.spanish, rect.chinese, rect.english, text.patois, text.polish, text.arabic, text.spanish, text.chinese, text.russian, tspan.english') 
                .style('fill-opacity', 1)
                .style('stroke-opacity', 1)
              d3.selectAll('text.extraInfo').remove()
              })

        d3.selectAll('#Polish, rect.polish, text.polish')
          .on('click', function() {
            console.log("clicked")
            d3.selectAll('text.extraInfo').remove()
            d3.selectAll('#Arabic, #Spanish, #Chinese_English, #English, #Chinese_Spanish_English, #Patois, #Russian, rect.russian, rect.patois, rect.arabic, rect.spanish, rect.chinese, rect.english, text.patois, text.russian, text.arabic, text.spanish, text.chinese, tspan.english') 
              .style('fill-opacity', 0.1)
              .style('stroke-opacity', 0.3)
            d3.selectAll('#Polish, rect.polish, text.polish') 
              .style('fill-opacity', 1)
              .style('stroke-opacity', 1)
            d3.select('p.extraInfo')
               .append('text')
                .attr("class","extraInfo")
                .text(polishDescription)
            })
              
        d3.selectAll('#Arabic, rect.arabic, text.arabic')
          .on('click', function() {
            d3.selectAll('text.extraInfo').remove()
            d3.selectAll('#Polish, #Spanish, #Chinese_English, #English, #Chinese_Spanish_English, #Patois, #Russian, rect.russian, rect.patois, rect.polish, rect.spanish, rect.chinese, rect.english, text.patois, text.polish, text.russian, text.spanish, text.chinese, tspan.english') 
              .style('fill-opacity', 0.1)
              .style('stroke-opacity', 0.3)
            d3.selectAll('#Arabic, rect.arabic, text.arabic') 
              .style('fill-opacity', 1)
              .style('stroke-opacity', 1)
            d3.select('p.extraInfo')
               .append('text')
                .attr("class","extraInfo")
                .text(arabicDescription)
            })

          d3.selectAll('#Spanish, rect.spanish, text.spanish')
          .on('click', function() {
            d3.selectAll('text.extraInfo').remove()
            d3.selectAll('#Polish, #Arabic, #Chinese_English, #English, #Patois, #Russian, rect.russian, rect.patois, rect.polish, rect.arabic, rect.chinese, rect.english, text.patois, text.polish, text.arabic, text.russian, text.chinese, tspan.english') 
              .style('fill-opacity', 0.1)
              .style('stroke-opacity', 0.3)
            d3.selectAll('#Chinese_Spanish_English, #Spanish, rect.spanish, text.spanish') 
              .style('fill-opacity', 1)
              .style('stroke-opacity', 1)
            d3.select('p.extraInfo')
               .append('text')
                .attr("class","extraInfo")
                .text(spanishDescription)
            })

          d3.selectAll('rect.chinese, text.chinese')
          .on('click', function() {
            d3.selectAll('text.extraInfo').remove()
            d3.selectAll('#Polish, #Arabic, #Spanish, #English, #Patois, #Russian, rect.russian, rect.patois, rect.polish, rect.arabic, rect.spanish, rect.english, text.patois, text.polish, text.arabic, text.spanish, text.russian, tspan.english') 
              .style('fill-opacity', 0.1)
              .style('stroke-opacity', 0.3)
            d3.selectAll('#Chinese_English, #Chinese_Spanish_English, rect.chinese, text.chinese') 
              .style('fill-opacity', 1)
              .style('stroke-opacity', 1)
            d3.select('p.extraInfo')
               .append('text')
                .attr("class","extraInfo")
                .text(chineseDescription)
            })

          d3.selectAll('#English, rect.english, tspan.english')
            .on('click', function() {
              d3.selectAll('text.extraInfo').remove()
              d3.selectAll('#Polish, #Arabic, #Spanish, #Patois, #Russian, rect.russian, rect.patois, rect.polish, rect.arabic, rect.spanish, rect.chinese, text.patois, text.polish, text.arabic, text.spanish, text.chinese, text.russian') 
                .style('fill-opacity', 0.1)
                .style('stroke-opacity', 0.3)
              d3.selectAll('#Chinese_English, #Chinese_Spanish_English, #English, rect.english, tspan.english') 
                .style('fill-opacity', 1)
                .style('stroke-opacity', 1)
              d3.select('p.extraInfo')
                 .append('text')
                  .attr("class","extraInfo")
                  .text(englishDescription)
            })

          d3.selectAll('#Chinese_Spanish_English')
          .on('click', function() {
            d3.selectAll('text.extraInfo').remove()
            d3.selectAll('#Polish, #Arabic, #Patois, #Russian, rect.russian, rect.patois, rect.polish, rect.arabic, text.patois, text.polish, text.arabic, text.russian') 
              .style('fill-opacity', 0.1)
              .style('stroke-opacity', 0.3)
            d3.selectAll('#Chinese_Spanish_English, #Chinese_English, #Spanish, #English, rect.spanish, rect.chinese, rect.english, text.spanish, text.chinese, tspan.english') 
              .style('fill-opacity', 1)
              .style('stroke-opacity', 1)
            d3.select('p.extraInfo')
               .append('text')
                .attr("class","extraInfo")
                .text(chineseSpanishEnglishDescription)
            })

          d3.selectAll('#Chinese_English')
          .on('click', function() {
            d3.selectAll('text.extraInfo').remove()
            d3.selectAll('#Polish, #Arabic, #Spanish, #Patois, #Russian, rect.russian, rect.patois, rect.polish, rect.arabic, rect.chinese, rect.spanish, text.patois, text.polish, text.arabic, text.russian, text.spanish') 
              .style('fill-opacity', 0.1)
              .style('stroke-opacity', 0.3)
            d3.selectAll('#Chinese_English, rect.chinese, rect.english, text.chinese, tspan.english') 
              .style('fill-opacity', 1)
              .style('stroke-opacity', 1)
            d3.select('p.extraInfo')
               .append('text')
                .attr("class","extraInfo")
                .text(chineseEnglishDescription)
            })

          d3.selectAll('#Patois, rect.patois, text.patois')
            .on('click', function() {
              d3.selectAll('text.extraInfo').remove()
              d3.selectAll('#Polish, #Spanish, #Chinese_English, #English, #Chinese_Spanish_English, #Arabic, #Russian, rect.russian, rect.patois, rect.polish, rect.arabic, rect.spanish, rect.chinese, rect.english, text.russian, text.polish, text.arabic, text.spanish, text.chinese, tspan.english') 
                .style('fill-opacity', 0.1)
                .style('stroke-opacity', 0.3)
              d3.selectAll('#Patois , rect.patois, text.patois') 
                .style('fill-opacity', 1)
                .style('stroke-opacity', 1)
              d3.select('p.extraInfo')
                 .append('text')
                  .attr("class","extraInfo")
                  .text(patoisDescription)
            })

          d3.selectAll('#Russian, rect.russian, text.russian')
            .on('click', function() {
              d3.selectAll('text.extraInfo').remove()
              d3.selectAll('#Polish, #Spanish, #Chinese_English, #English, #Chinese_Spanish_English, #Arabic, #Patois, rect.patois, rect.polish, rect.arabic, rect.spanish, rect.chinese, rect.english, text.patois, text.polish, text.arabic, text.spanish, text.chinese, tspan.english') 
                .style('fill-opacity', 0.1)
                .style('stroke-opacity', 0.3)
              d3.selectAll('#Russian, rect.russian, text.russian') 
                .style('fill-opacity', 1)
                .style('stroke-opacity', 1)
              d3.select('p.extraInfo')
                 .append('text')
                  .attr("class","extraInfo")
                  .text(russianDescription)              
            })
          } //end of function




    </script>

</html>